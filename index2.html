<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">
    <!--<link rel="icon" href="../../favicon.ico">-->
    <title>Kickoff Haircuts</title>
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
    <!-- Custom styles for this template -->
    <link href="/cover.css" rel="stylesheet">
    <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
    <!-- Just for debugging purposes. Don't actually copy these 2 lines! -->
    <!--[if lt IE 9]><script src="../../assets/js/ie8-responsive-file-warning.js"></script><![endif]-->
    <!-- // <script src="../../assets/js/ie-emulation-modes-warning.js"></script> -->
    <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
        <script src="//oss.maxcdn.com/html5shiv/3.7.2/html5shiv.min.js"></script>
        <script src="//oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
        <![endif]-->
    <script>
    if (window.location.href.indexOf('localhost') > -1) {
        // dev settings
        remoteURL = "http://localhost:1000"
        fbAppID = '665166830283009'
    } else {
        // prod settings
        remoteURL = "http://kickoffcheckin.azurewebsites.net"
        fbAppID = '585127968286896'
    }
    </script>
</head>

<body>
    <div class="header">
        <div class="content clearfix">
            <a href="/">
                <img src="/logo.png" class="logo pull-left" />
            </a>
            <ul class="header-nav pull-right">
                <!--<li class="active"><a href="#">Home</a></li>-->
                <li><a href="#locations"><span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>&nbsp;<span class="hidden-xs">Online&nbsp;</span>Check-in</a></li>
                <!--<li><a href="#">Contact</a></li>-->
            </ul>
        </div>
    </div>
    <!--Use Tab and Tab-Name to display Sections-->
    <!--Centered content put in the tab-->
    <div class="tab tab-main">
        <div class="content">
            <h1>Haircuts Exclusively for Everybody</h1>
            <p class="lead" style="font-size:1.8em;">Cheers! We are here to make you look your best</p>
            <p class="lead">
                <a id="id" href="#" class="contact btn btn-primary btn-lg">
                    <span class="glyphicon glyphicon-question-sign" aria-hidden="true"></span> Learn More
                </a>
            </p>
        </div>
    </div>
    <div class="tab tab-locations">
        <div class="content">
            <h1 id="locations" style="margin-top: 0px; display:inline-block">Online Check-in</h1>&nbsp;&nbsp;<em class="hidden-xs" style="display:inline-block">No more waiting, check-in online and walk right in</em>
            <hr style="margin-top:0;" />
            <div class="location">
                <h3>
                    <span>Kickoff Haircuts in Prospect</span>
                    <a class="btn btn-success" target="_blank" href="https://www.google.com/maps/place/Kickoff+Haircuts/@38.364585,-85.601482,17z/data=!3m1!4b1!4m2!3m1!1s0x88699d7e3d8b4bd7:0x26e462ad9eb35e9a">
                    <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span>  Map
                    </a>
<!--                     <a id="hiring" class="btn btn-danger">
                    <span class="glyphicon glyphicon-user" aria-hidden="true"></span>  Now Hiring
                    </a> -->
                    </h3>
                <p>
                    <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> 13206 W U.S. Hwy 42 #112, Prospect, KY 40059
                    <br />
                    <!-- Opening early March -->
                    <a href="tel://1-502-963-1749" style="color:#fff;"><span class="glyphicon glyphicon-phone-alt" aria-hidden="true"></span>  (502) 963-1749</a>
                </p>
                <p class="lead">
                    <button style="opacity: 1" id="checkin" type="button" onclick="checkin()" class="btn btn-info btn-lg btn-block">
                        <!-- <span class="glyphicon glyphicon-map-marker" aria-hidden="true"></span> Check-in : 10 min Wait -->
                    </button>
                </p>
                <div>
                    <div>
                        <b style="width:80px; display:inline-block">Mon-Fri</b>
                        <span>10:00 am – 8:00 pm</span>
                    </div>
                    <div>
                        <b style="width:80px; display:inline-block">Saturday</b>
                        <span>11:00 am – 6:00 pm</span>
                    </div>
                    <div>
                        <b style="width:80px; display:inline-block">Sunday</b>
                        <span>11:00 am – 5:00 pm</span>
                    </div>
                </div>
                <div class="location">
                    <h3>Stay tuned for more store announcements</h3>
                </div>
            </div>
        </div>
    </div>
    <div class="tab tab-footer">
        <div class="content">
            <div class="clearfix">
                <p>
                    <span>
                        &copy;
                        Kickoff Haircuts™ 2015
                    </span>
                    <span style="padding: 6px 12px;">|</span>
                    <a id="hiring" href="#">Apply for Job</a>
                </p>
                <!--<div class="pull-left">
                                                                                                                    tweet
                                                                                                                    <a href="https://twitter.com/kickoffhaircuts" class="twitter-follow-button" data-show-count="false" data-size="large">Follow @kickoffhaircuts</a>
                        <script>!function (d, s, id) { var js, fjs = d.getElementsByTagName(s)[0], p = /^http:/.test(d.location) ? 'http' : 'https'; if (!d.getElementById(id)) { js = d.createElement(s); js.id = id; js.src = p + '://platform.twitter.com/widgets.js'; fjs.parentNode.insertBefore(js, fjs); } }(document, 'script', 'twitter-wjs');</script>
                    </div>-->
                <!-- yelp -->
                <!-- <div id="yelp-biz-badge-plain-SUwD6Sbk117pwlChY9mnoA"><a href="http://www.yelp.com/biz/kickoff-haircuts-prospect">Check out Kickoff Haircuts on Yelp</a></div><script type="text/javascript">(function(d, t) {var g = d.createElement(t);var s = d.getElementsByTagName(t)[0];g.id = "yelp-biz-badge-script-plain-SUwD6Sbk117pwlChY9mnoA";g.src = "//dyn.yelpcdn.com/biz_badge_js/en_US/plain/SUwD6Sbk117pwlChY9mnoA.js";s.parentNode.insertBefore(g, s);}(document, 'script'));</script>
                    -->
                <!-- facebook -->
                <div class="pull-left">
                    <div class="fb-like" data-href="http://facebook.com/kickoffhaircuts/" data-share="true" data-width="450" data-show-faces="true">
                    </div>
                </div>
            </div>
        </div>
        <!-- Bootstrap core JavaScript
            ================================================== -->
        <!-- Placed at the end of the document so the pages load faster -->
        <!--script src="//code.jquery.com/jquery-2.1.1.min.js"></script>
            <script src="//maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script-->
        <!-- // <script src="../../assets/js/docs.min.js"></script> -->
        <!-- IE10 viewport hack for Surface/desktop Windows 8 bug -->
        <!-- // <script src="../../assets/js/ie10-viewport-bug-workaround.js"></script> -->
        <script>
        // Include the UserVoice JavaScript SDK (only needed once on a page)
        UserVoice = window.UserVoice || [];
        (function() {
            var uv = document.createElement('script');
            uv.type = 'text/javascript';
            uv.async = true;
            uv.src = '//widget.uservoice.com/dTeshIom12e6OSi4Efs4SA.js';
            var s = document.getElementsByTagName('script')[0];
            s.parentNode.insertBefore(uv, s)
        })();
        //
        // UserVoice Javascript SDK developer documentation:
        // https://www.uservoice.com/o/javascript-sdk
        //
        // Set colors
        UserVoice.push(['set', {
            accent_color: '#448dd6',
            trigger_color: 'white',
            trigger_background_color: 'rgba(46, 49, 51, 0.6)'
        }]);
        // Identify the user and pass traits
        // To enable, replace sample data with actual user traits and uncomment the line
        UserVoice.push(['identify', {
            //email:      'john.doe@example.com', // User’s email address
            //name:       'John Doe', // User’s real name
            //created_at: 1364406966, // Unix timestamp for the date the user signed up
            //id:         123, // Optional: Unique id of the user (if set, this should not change)
            //type:       'Owner', // Optional: segment your users by type
            //account: {
            //  id:           123, // Optional: associate multiple users with a single account
            //  name:         'Acme, Co.', // Account name
            //  created_at:   1364406966, // Unix timestamp for the date the account was created
            //  monthly_rate: 9.99, // Decimal; monthly rate of the account
            //  ltv:          1495.00, // Decimal; lifetime value of the account
            //  plan:         'Enhanced' // Plan name for the account
            //}
        }]);
        // Add default trigger to the bottom-right corner of the window:
        // UserVoice.push(['addTrigger', { mode: 'contact', trigger_position: 'top-right' }]);
        // Or, use your own custom trigger:
        UserVoice.push(['addTrigger', '#id', {
            mode: 'contact'
        }]);
        UserVoice.push(['addTrigger', '#hiring', {
            mode: 'contact'
        }]);
        // Autoprompt for Satisfaction and SmartVote (only displayed under certain conditions)
        UserVoice.push(['autoprompt', {}]);
        </script>
        <script>
        (function(i, s, o, g, r, a, m) {
            i['GoogleAnalyticsObject'] = r;
            i[r] = i[r] || function() {
                (i[r].q = i[r].q || []).push(arguments)
            }, i[r].l = 1 * new Date();
            a = s.createElement(o),
                m = s.getElementsByTagName(o)[0];
            a.async = 1;
            a.src = g;
            m.parentNode.insertBefore(a, m)
        })(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');
        ga('create', 'UA-57801538-1', 'auto');
        ga('send', 'pageview');
        </script>
        <!-- Social networking maintance
                                                        Twitter, facebook, google places, yelp, foursquare
            -->
        <!-- facebook script -->
        <script>
        window.fbAsyncInit = function() {
            FB.init({
                appId: fbAppID,
                xfbml: true,
                version: 'v2.3'
            });
            // check login status, load in here so FB is created
            FB.getLoginStatus(function(response) {
                statusChangeCallback(response, function() {
                    // user is logged in get checkinstatus
                    FB.api('/me', function(response) {
                        getCheckinStatus(response, false);
                    });
                });
            });
        };
        (function(d, s, id) {
            var js, fjs = d.getElementsByTagName(s)[0];
            if (d.getElementById(id)) {
                return;
            }
            js = d.createElement(s);
            js.id = id;
            js.src = "//connect.facebook.net/en_US/sdk.js";
            fjs.parentNode.insertBefore(js, fjs);
        }(document, 'script', 'facebook-jssdk'));
        // checkin clicked
        function checkin() {
                // is user logged in
                FB.getLoginStatus(function(response) {
                    statusChangeCallback(response, function() {
                        // user is logged in get checkinstatus
                        FB.api('/me', function(response) {
                            console.log(response);
                            getCheckinStatus(response, true);
                        });
                    }, function() {
                        // if not logged in then login
                        alert('You will be prompted to login using Facebook, select Allow to checkin');
                        
                        FB.login(function(response) {
                            statusChangeCallback(response, function() {
                                FB.api('/me', function(response) {
                                    console.log(response);
                                    getCheckinStatus(response, true);
                                });

                            }, {
                                scope: 'public_profile,email'
                            });
                        }, {
                            scope: 'public_profile, email',
                            return_scopes: true
                        });
                    });
                });
            }
            // This is called with the results from from FB.getLoginStatus().
        function statusChangeCallback(response, loggedIn, notLoggedin) {
            console.log('statusChangeCallback');
            console.log(response);
            // The response object is returned with a status field that lets the
            // app know the current login status of the person.
            // Full docs on the response object can be found in the documentation
            // for FB.getLoginStatus().
            if (response.status === 'connected') {
                // Logged into your app and Facebook.
                if (loggedIn) loggedIn();
            } else if (response.status === 'not_authorized') {
                if (notLoggedin) notLoggedin();
                // The person is logged into Facebook, but not your app.
            } else {
                if (notLoggedin) notLoggedin();
                // The person is not logged into Facebook, so we're not sure if
                // they are logged into this app or not.
            }
        }

        function getCheckinStatus(response, checkin) {
            // get checkedin status
            $.get(remoteURL + '/api/mecheckedin_online', response, function(data) {
                if (data.found) {
                    $('#checkin').addClass('btn-danger').html(
                        "<span class='glyphicon glyphicon-map-marker' aria-hidden='true'></span> You are checked in for next " + data.till + " minutes")
                    $('#checkin').attr('disabled', 'disabled');
                    return;
                }
                // checkin needed
                if (checkin) {
                    // if (confirm('Checkin Now?')) {
                        // Checkin now
                        $.post(remoteURL + '/api/checkin_online', response, function(data) {
                            console.log('checkin_online', data);
                            alert('You have been checked in for next 30 minutes')
                                // redraw checkin
                            getCheckinStatus(response, false);
                        });
                    // }
                }

            });
        }

        $(function() {
            $.get(remoteURL + '/api/wait', function(data) {
                if (data.wait == 0) {
                    data.wait = "No Wait"
                } else if (data.wait == null) {
                    data.wait = "Closed Now"
                    $('#checkin').attr('disabled', 'disabled');
                } else {
                    data.wait = data.wait + " Min Wait"
                }

                $('#checkin').html("<span class='glyphicon glyphicon-map-marker' aria-hidden='true'></span> Check-in : " + data.wait)
            });
        });
        // checkin process
        //  load page
        //      is id logged in?
        //          YES has user checked in?
        //          NO, show wait
        //      user click checkin
        //          if user not logged in then login
        //          checkin and show page and update checkin
        //      TODO LATER: login to see your checkin status
        </script>
</body>

</html>

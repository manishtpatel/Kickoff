{"version":3,"sources":["../src/index.jsx"],"names":[],"mappings":"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","file":"out.js","sourcesContent":["// DataStore for CheckinLink\r\n// {\r\n//    loading: true,\r\n//    wait: 0,\r\n//    checkedIn: false,\r\n//    till: 10,\r\n//    showCheckinForm: false\r\n// }\r\nvar CheckinLink = React.createClass({\r\n  getInitialState: function() {\r\n    return checkinDataStore.initValue;\r\n  },\r\n  componentDidMount: function() {\r\n    var component = this; \r\n\r\n    // bind event for triggering state update\r\n    $(\"body\").on(\"checkinlink_setstate\", function(event, data) {\r\n        component.setState(data);\r\n    });\r\n\r\n    // once component mounts get status from server\r\n    checkinDataStore.setFromServer(false);\r\n  },\r\n  componentWillUnmount: function(){\r\n  },\r\n  handleClick: function(event){\r\n    checkinDataStore.showCheckinForm(!this.state.showCheckinForm);\r\n  },\r\n  render: function() {\r\n  \t  var buttonStyle = {\r\n  \t    opacity: 1\r\n  \t  };\r\n      var btnClass = \"btn btn-info btn-lg btn-block\" + ((this.state.checkedIn)? \" btn-danger\": \" \");\r\n      var canCheckin = false;\r\n      var displayMessage = \"Check-in : \";\r\n      var mapMarkerClassName = \"glyphicon glyphicon-map-marker\";\r\n      var showCheckinFormStyle = {\r\n        display : ((this.state.showCheckinForm)? \"\" : \"none\")\r\n      }\r\n\r\n      if(this.state.loading){\r\n        return (\r\n          <div>\r\n            <button style={buttonStyle} type=\"button\" disabled className=\"btn btn-info btn-lg btn-block\">\r\n              <span className=\"fa fa-refresh fa-spin\" aria-hidden=\"true\"></span>&nbsp;\r\n            </button>\r\n          </div>\r\n        );\r\n      }\r\n\r\n      // build display message and set disabled\r\n      if(this.state.open){\r\n        if(this.state.checkedIn){\r\n          displayMessage += \"You are checked in for next \" + this.state.till + \" minutes\"\r\n        } else {\r\n          canCheckin = true;\r\n\r\n          if(this.state.wait == 0){\r\n            displayMessage += \"No Wait\";\r\n          } else {\r\n            displayMessage += this.state.wait + \" Min Wait\";\r\n          }\r\n        }\r\n      } else {\r\n        displayMessage += \"Closed Now\";\r\n      }\r\n\r\n      return (\r\n      \t<div>\r\n          <div>\r\n        \t\t<button style={buttonStyle} type=\"button\" disabled={!canCheckin} onClick={this.handleClick} className={btnClass}>\r\n              <span style={showCheckinFormStyle}><span className=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>&nbsp;&nbsp;</span>\r\n        \t\t\t<span className={mapMarkerClassName} aria-hidden=\"true\"></span>&nbsp;\r\n        \t\t\t{displayMessage}&nbsp;&nbsp;\r\n              <span style={showCheckinFormStyle}><span className=\"fa fa-arrow-down\" aria-hidden=\"true\"></span>&nbsp;</span>\r\n        \t\t</button>\r\n          </div>\r\n          <CheckinForm show={this.state.showCheckinForm} />\r\n      \t</div>\r\n    );\r\n  }\r\n});\r\n\r\nvar CheckinForm = React.createClass({\r\n  handleSubmit: function(event){\r\n    event.preventDefault();\r\n\r\n    var formData = {\r\n      name: React.findDOMNode(this.refs.name).value.trim(),\r\n      email: React.findDOMNode(this.refs.email).value.trim()\r\n    };\r\n\r\n    checkinDataStore.newCheckin(formData);\r\n  },\r\n  render: function() {\r\n    var myStyle = {\r\n      display: ((this.props.show) ? \"\" : \"none\"),\r\n      'padding': 10\r\n    };\r\n\r\n    return (\r\n      <div style={myStyle}>\r\n        <form onSubmit={this.handleSubmit}>\r\n          <div className=\"form-group\">\r\n            <input type=\"text\" className=\"form-control\" required placeholder=\"Full Name\" ref=\"name\" />\r\n          </div>\r\n          <div className=\"form-group\">\r\n            <input type=\"email\" className=\"form-control\" placeholder=\"Enter eMail\" ref=\"email\" />\r\n          </div>\r\n          <button type=\"submit\" className=\"btn btn-danger btn-lg\">Check-in</button>\r\n        </form>\r\n      </div>\r\n    );\r\n  }\r\n});\r\n\r\ncheckinDataStore = function() {\r\n    // initial value\r\n    var nowValue = {\r\n        loading: true,\r\n        open: false,\r\n        wait: 0,\r\n        checkedIn: false,\r\n        till: 0,\r\n        showCheckinForm: false\r\n    };\r\n\r\n    // do update manipulation based on state and setstate\r\n    var triggerSetState = function(loadingStill) {\r\n        // apply rules here first\r\n        if (!nowValue.open) {\r\n            nowValue.showCheckinForm = false;\r\n        }\r\n\r\n        if (nowValue.checkedIn) {\r\n            nowValue.showCheckinForm = false;\r\n        }\r\n\r\n        nowValue.loading = !!loadingStill;\r\n\r\n        // now trigger setState with new Value\r\n        $('body').trigger('checkinlink_setstate', nowValue);\r\n    };\r\n\r\n    // get value from server and setstate, optional setloading as multiple ajax may want to update it at the end only\r\n    var setFromServer = function(laodingStill) {\r\n        var checkinID = document.cookie.replace(/(?:(?:^|.*;\\s*)checkinID\\s*\\=\\s*([^;]*).*$)|^.*$/, \"$1\");\r\n\r\n        // load state from server here\r\n        $.get(remoteURL + '/api/myStatus', {\r\n            checkinID: checkinID\r\n        }, function(data) {\r\n            nowValue.open = data.open;\r\n            nowValue.wait = data.wait;\r\n            nowValue.checkedIn = data.checkedIn;\r\n            nowValue.till = data.till;\r\n\r\n            triggerSetState(laodingStill);\r\n        });\r\n    };\r\n\r\n    // show checkin form\r\n    var showCheckinForm = function(show) {\r\n        nowValue.showCheckinForm = show;\r\n\r\n        triggerSetState();\r\n    }\r\n\r\n    // newcheckin process\r\n    var newCheckin = function(formData) {\r\n        triggerSetState(true);\r\n\r\n        $.post(remoteURL + '/api/checkin_online', formData, function(data) {\r\n            alert('Thank you, you have been checked in');\r\n\r\n            // add cookie so we remember him, ajax is making request to another domain so set cookie in js\r\n            document.cookie = 'checkinID=' + data._id + '; Path=/; Expires=' + new Date(Date.now() + 999999999999);\r\n\r\n            setFromServer(false);\r\n        });\r\n    };\r\n\r\n    // every one minute update\r\n    setInterval(setFromServer, 60000);\r\n\r\n    return {\r\n        // get initial value\r\n        initValue: nowValue,\r\n        setFromServer: setFromServer,\r\n        showCheckinForm: showCheckinForm,\r\n        newCheckin: newCheckin\r\n    }\r\n}();\r\n\r\n// load facebook api\r\n$(function() {\r\n    window.fbAsyncInit = function() {\r\n        FB.init({\r\n            appId: fbAppID,\r\n            xfbml: true,\r\n            version: 'v2.3'\r\n        });\r\n    };\r\n    (function(d, s, id) {\r\n        var js, fjs = d.getElementsByTagName(s)[0];\r\n        if (d.getElementById(id)) {\r\n            return;\r\n        }\r\n        js = d.createElement(s);\r\n        js.id = id;\r\n        js.src = \"//connect.facebook.net/en_US/sdk.js\";\r\n        fjs.parentNode.insertBefore(js, fjs);\r\n    }(document, 'script', 'facebook-jssdk'));\r\n});\r\n\r\n// render reactjs\r\n$(function() {\r\n    React.render(\r\n        <CheckinLink /> ,\r\n        document.getElementById('checkin_button')\r\n    );\r\n})\r\n"]}